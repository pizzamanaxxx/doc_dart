
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="DART_functionalities_and_products/4-Radiative_modes_sub_modes/4.11/atmosphere.html">
      
      
        <link rel="prev" href="../4.10/earth_scene.html">
      
      
        <link rel="next" href="../4.12/inversion.html">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.11">
    
    
      
        <title>4.11 Atmosphere - DART User's Manual</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-atmosphere-geometric-and-optical-properties" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="DART User&#39;s Manual" class="md-header__button md-logo" aria-label="DART User's Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DART User's Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              4.11 Atmosphere
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="DART User&#39;s Manual" class="md-nav__button md-logo" aria-label="DART User's Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    DART User's Manual
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          I. Remote sensing and radiative budget modeling of natural and urban surfaces
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          I. Remote sensing and radiative budget modeling of natural and urban surfaces
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Remote_sensing/remote_sensing.html" class="md-nav__link">
        Remote sensing and radiative budget modeling of natural and urban surfaces
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          II. DART model
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          II. DART model
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../DART_model/dart_model.html" class="md-nav__link">
        DART Model
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          III. DART functionalities and products
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          III. DART functionalities and products
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-File_architecture/file_architecture.html" class="md-nav__link">
        1 - File Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-GUI/gui.html" class="md-nav__link">
        2 - Graphical User Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3-Editor_of_simulation/editor_of_simulation.html" class="md-nav__link">
        3 - Editor of simulation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          4 - RADIATIVE MODES, SUB-MODES, PARAMETERS and PRODUCTS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          4 - RADIATIVE MODES, SUB-MODES, PARAMETERS and PRODUCTS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.1/radiative_parameters.html" class="md-nav__link">
        4.1 Radiative parameters identical in 'Passive RS & RB' and 'LiDAR'
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.2/passive_rs_rb_dart_ft.html" class="md-nav__link">
        4.2 Passive RS & RB: Forward mode (DART-FT)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.3/passive_rs_rb_dart_lux.html" class="md-nav__link">
        4.3 Passive RS & RB: Bi-directionnal sub-mode (DART-Lux)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.4/monte_carlo.html" class="md-nav__link">
        4.4 Monte Carlo (DART-MC)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.5/lidar_forward_dart_rc.html" class="md-nav__link">
        4.5 LiDAR: Forward mode (DART-RC)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.6/lidar_bidirectional_dart_lux.html" class="md-nav__link">
        4.6 LiDAR: Bi-directional sub-mode (DART-Lux LiDAR)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.7/earth_scene_products.html" class="md-nav__link">
        4.7 Earth scene products
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.8/directions_of_rays.html" class="md-nav__link">
        4.8 Direction of rays
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.9/optical_and_temperature_properties.html" class="md-nav__link">
        4.9 Optical and Temperatures properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.10/earth_scene.html" class="md-nav__link">
        4.10 The Earth scene
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          4.11 Atmosphere
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="atmosphere.html" class="md-nav__link md-nav__link--active">
        4.11 Atmosphere
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-atmosphere-geometric-and-optical-properties" class="md-nav__link">
    1) Atmosphere geometric and optical properties
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.12/inversion.html" class="md-nav__link">
        4.12 Inversion (being removed)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
      
      
      
        <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
          5 - Run menu
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          5 - Run menu
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5-Run_menu/5.1/dart_basic_modules.html" class="md-nav__link">
        5.1 DART basic modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5-Run_menu/5.2/the_lut.html" class="md-nav__link">
        5.2 The LUT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5-Run_menu/5.3/sequencer_module.html" class="md-nav__link">
        5.3 Sequencer module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5-Run_menu/5.4/python_scripts.html" class="md-nav__link">
        5.4 Python scripts to run DART
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
      
      
      
        <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
          6 - View menu
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          6 - View menu
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.1/view_scene_2d_3d.html" class="md-nav__link">
        6.1 View scene 3D and 2D
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.2/view_image.html" class="md-nav__link">
        6.2 View image
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.3/3d_object_viewer.html" class="md-nav__link">
        6.3 3D object viewer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.4/directions_3d_view.html" class="md-nav__link">
        6.4 Directions 3D view
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.5/directional_reflectance_temp.html" class="md-nav__link">
        6.5 Directional reflectance/Temperature 1D & 2D
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.6/lidar.html" class="md-nav__link">
        6.6 LiDAR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.7/surface_radiative_budget.html" class="md-nav__link">
        6.7 Surface radiative budget (RB)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.8/lut.html" class="md-nav__link">
        6.8 LUT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-View_menu/6.9/report_data_files.html" class="md-nav__link">
        6.9 Report / data files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
      
      
      
        <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
          7 - Tools menu: run DART tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          7 - Tools menu: run DART tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.1/sail_model.html" class="md-nav__link">
        7.1 SAIL model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.2/leaf_spectra_inversion.html" class="md-nav__link">
        7.2 Leaf spectra inversion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.3/computation_parametric_model_coef.html" class="md-nav__link">
        7.3 Computation of parametric model coefficients
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.4/3d_objects_creation.html" class="md-nav__link">
        7.4 Creation of 3D objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.5/lut_tools.html" class="md-nav__link">
        7.5 LUT tools: BRF model inversion and noised LUT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.6/topography_tools.html" class="md-nav__link">
        7.6 Topography tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.7/covermap_importation.html" class="md-nav__link">
        7.7 CoverMap importation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.8/band_calculation_tools.html" class="md-nav__link">
        7.8 Band calculation tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.9/color_composite.html" class="md-nav__link">
        7.9 Color composite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.10/3d_radiative_budget_extractor.html" class="md-nav__link">
        7.10 3D Radiative budget extractor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Tools_menu/7.11/dart_database_manager.html" class="md-nav__link">
        7.11 DART database manager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          IV. Format of DART files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          IV. Format of DART files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Format_DART_files/1-All_dart_modes/all_dart_modes.html" class="md-nav__link">
        1 - All DART modes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Format_DART_files/2-DART_FT/dart_ft.html" class="md-nav__link">
        2 - DART-FT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Format_DART_files/3-DART_RC/dart_rc.html" class="md-nav__link">
        3 - DART-RC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Format_DART_files/4-DART_LUX/dart_lux.html" class="md-nav__link">
        4 - DART-Lux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          V - General advices
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          V - General advices
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../General_advices/general_advices.html" class="md-nav__link">
        **General Advices**
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          VI - Physical bases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          VI - Physical bases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Physical_bases/physical_bases.html" class="md-nav__link">
        **Physical bases**
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          VII. Work packages
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          VII. Work packages
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T0/t0.html" class="md-nav__link">
        WP0 - DART Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T1/t1.html" class="md-nav__link">
        WP1 - Reflectance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T2/t2.html" class="md-nav__link">
        WP2 - Temperature
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T3/t3.html" class="md-nav__link">
        WP3 - House, Specular and polarized reflectance, atmosphere
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T4/t4.html" class="md-nav__link">
        WP4 - Radiative Budget (RB) and sun induced fluorescence (SIF)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T5/t5.html" class="md-nav__link">
        WP5 - Fluids and CoverMap importation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T6/t6.html" class="md-nav__link">
        WP6 - Trees - creation and importation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T7/t7.html" class="md-nav__link">
        WP7 - Topography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T8/t8.html" class="md-nav__link">
        WP8 - LiDAR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T9/t9.html" class="md-nav__link">
        WP9 - Airborne and in-situ sensors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T10/t10.html" class="md-nav__link">
        WP10 - RAMI Experiment - run of DART using python scripts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T11/t11.html" class="md-nav__link">
        WP11 - Mapping global sun radiometric quantities (out of date)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/T12/t12.html" class="md-nav__link">
        WP12 - Satellite image inversion (under development)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          Annexes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Annexes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Annexes/Annex1/annex1.html" class="md-nav__link">
        Annex 1: DART Python modules / scripts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Annexes/Annex2/annex2.html" class="md-nav__link">
        Annex 2: DART Albedo and Ortho images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Annexes/Annex3/annex3.html" class="md-nav__link">
        Annex 3: AERONET and ECMWF data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Annexes/Annex4/annex4.html" class="md-nav__link">
        Annex 4: Forest simulation with DART-Lux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Annexes/Annex5/annex5.html" class="md-nav__link">
        Annex 5: Field of trees that are the clones of a DART created 3D (facet) tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Annexes/Annex6/annex6.html" class="md-nav__link">
        Annex 6: Optimal domain of leaf variables to get leaf optical properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Annexes/Annex7/annex7.html" class="md-nav__link">
        Annex 7: List of abbreviations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-atmosphere-geometric-and-optical-properties" class="md-nav__link">
    1) Atmosphere geometric and optical properties
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>4.11 Atmosphere</h1>

<h3 id="1-atmosphere-geometric-and-optical-properties">1) <strong>Atmosphere geometric and optical properties</strong></h3>
<p>The phase module computes gas, aerosol and cloud scattering transfer functions T({<span class="arithmatex">\(\Omega_i ,\Delta \Omega_i\)</span>}→{<span class="arithmatex">\(\Omega_j ,\Delta \Omega_j\)</span>}), as integrals on <span class="arithmatex">\(\Delta \Omega_i\)</span> and <span class="arithmatex">\(\Delta \Omega_j\)</span>. The Earth scene can contain air as plots of fluid or extrapolation of all or part of atmosphere gases. The atmosphere can be simulated without or with an atmosphere database.</p>
<ul>
<li><strong>Atmosphere without database: single band</strong></li>
</ul>
<p>Parameters: gas/aerosol geometry (exponential scale height <span class="arithmatex">\(H_{gas}, H_{aerosol}\)</span>), OPs (optical depth, scattering phase function).</p>
<ul>
<li><strong>Atmosphere with database (cf. IV.12):spectral</strong><ul>
<li><u><em>Gases</em></u>: spectral transmittance (TRANS) of absorbing and scattering gases and gas density profile (DENS). 6 models: 'Mid-latitude summer + winter', 'Sub-Arctic summer + winter', 'Tropical', 'US standard 1976'. <span class="arithmatex">\(H_2O\)</span> transmittance <span class="arithmatex">\(T_{H_2O}\)</span> (table gas_model_g<span class="arithmatex">\(H_2O\)</span>): for N <span class="arithmatex">\(H_2O\)</span> contents (default value x 0.1 n; <span class="arithmatex">\(n \in [1\:;\:N]\)</span>).</li>
<li><u><em>Aerosols</em></u>: extinction coefficient vertical profile (ECP), spectral optical depth <span class="arithmatex">\(\Delta \tau(\lambda)\)</span> &amp; single scattering albedo <span class="arithmatex">\(\omega(\lambda)\)</span> (gas_model_AOD) and coefficients (g1, g2, a) of 2 Henyey Greenstein scattering phase functions (HG). The term “gas_model” indicates 1 of the 6 gas models.</li>
</ul>
</li>
</ul>
<p>ECP: 8 aerosol models - <code>Rural V=23km &amp; V=5km</code>, <code>Maritime V=23km</code>, <code>Urban V=5km</code>, <code>Troposphere V=50km</code>, <code>Fog radiation V=0.5km</code>, <code>Fog advective V=0.2km</code>, <code>Desert V=76km</code>; V = visibility. gas_model_AOD: 48 models (i.e., the above 8 aerosol models for each of the 6 gas models). HG: 26 models - <code>Rural</code>, <code>Maritime</code>, <code>Urban</code>, <code>Ocean</code> and <code>Troposphere V=50km</code> for 4 relative humidities (RH: 0, 70, 80, 99%) + 6 models independent of humidity: <code>Fog radiation V=0.5km</code>, <code>Fog advective V=0.2km</code>, <code>Desert V=76km</code>, <code>STRT H2SO4</code>, <code>Aged Volcanic</code> and <code>MET_Dust</code>. </p>
<p>There is also a "Cloud" model with spectrally constant ECP and scattering albedo.</p>
<p>Two approaches allow one to simulate actual atmosphere conditions, for any <span class="arithmatex">\(\Delta \lambda_{user}\)</span>:</p>
<ol>
<li>
<p>Import new data (Aeronet: <a href="https://aeronet.gsfc.nasa.gov/">aeronet.gsfc.nasa.gov/</a>, ECMWF: <a href="https://www.ecmwf.int/">www.ecmwf.int/</a>,...) into atmosphere database.</p>
</li>
<li>
<p>Automatic weighting / interpolation of the atmosphere database, using options that directly modify:</p>
<ul>
<li>Gas (scattering, absorbing other than <span class="arithmatex">\(H_2O\)</span> / <span class="arithmatex">\(CO_2\)</span>) amount: multiplicative factor on default gas profile.</li>
<li><span class="arithmatex">\(H_2O\)</span> content, defined either as total amount, density or multiplicative factor on default <span class="arithmatex">\(H_2O\)</span> profile. Atmosphere transmittance <span class="arithmatex">\(T_{H_2O}\:\forall\: \Delta \lambda_{use}\)</span> is derived from interpolation on tables of gas_model_g<span class="arithmatex">\(H_2O\)</span>.</li>
<li>CO2 concentration: mixing rate (ppm).</li>
<li>Aerosol optical depth: factor <span class="arithmatex">\(K_{aer} \implies \Delta \tau_{aer}(\lambda) = K_{aer}.\Delta \tau_{aer,database}(\lambda)\)</span> (<span class="arithmatex">\(\Delta \tau_{rural,V10}=0.301, \Delta \tau_{rural,V23}=0.554\)</span>)</li>
<li>Temperature profile up to 10km: one sets <span class="arithmatex">\(T_0\)</span> for <span class="arithmatex">\(z' \implies T_{atm}(z) \rightarrow T_{atm}(z) + (T_0 - T_{atm}(z'))\)</span>,  <span class="arithmatex">\(\forall z &lt; 10km\)</span>.</li>
</ul>
</li>
</ol>
<p><u><em>Band model correction</em></u>. Since Beer law is inaccurate in gas absorption bands <span class="arithmatex">\(\Delta \lambda\)</span>, we use <span class="arithmatex">\(T_{atm}^{\uparrow}(\lambda, \Delta \lambda) = \frac {T_{atm}^{\downarrow \uparrow}(\lambda, \Delta \lambda)} {T_{atm}^{\downarrow}(\lambda, \Delta \lambda)}\)</span> in modes R and R+T if <span class="arithmatex">\(\lambda &gt; 3 \mu m\)</span>, <span class="arithmatex">\(T_{atm}^{\downarrow \uparrow}(\lambda, \Delta \lambda) = [T_{atm}^{\downarrow}(\lambda, \Delta \lambda)]^2\)</span>.</p>
<p><span class="arithmatex">\(T_{atm}^{\downarrow \uparrow}(\lambda, \Delta \lambda)\)</span> is corrected if water vapor load differs from its default value in the atmosphere database:</p>
<p><span class="arithmatex">\(T_{gas,abs}^{\uparrow \downarrow} = T_{gas,abs, database}^{\uparrow \downarrow}.\frac {T_{H_20}^2} {T_{H_20,database}^2}\)</span> and <span class="arithmatex">\(T_{H_20}=\)</span> linear interpolation on <span class="arithmatex">\(T_{H_20,database}\)</span> in database <code>*_gH20</code>.</p>
<p><center><img src="./media/atmosphere_menu_without_database.png"><p><em>The Atmosphere menu "without database"; only with user-defined parameters.</em></p></img></center></p>
<p><center><img src="./media/atmosphere_menu_database.png"><p><em>The Atmosphere menu with the database.</em></p></img></center></p>
<p><center><img src="./media/selection_components_dart_products.png"><p><em>Selection of components of DART products (reflectance <span class="arithmatex">\(\rho\)</span>, radiance L, irradiance E, exitance M, albedo A images) at Sensor level for 3 illumination configurations.</em></p>
<ul>
<li>a) <em>Upward products "j": None (<span class="arithmatex">\(L_{TOA}^{\uparrow}\)</span>), pure atmosphere, Direct (d), Diffuse (h), Total (t).</em></li>
<li>b) <em>3 illumination configurations: Direct (d), Diffuse (h) and Total (t).</em></li>
<li>
<p>c) <em>Menu for selecting the different products and illumination configurations.</em></p></img></center></p>
</li>
<li>
<p><strong> Pre-computation of atmosphere optical properties</strong> </p>
</li>
</ul>
<p><span class="arithmatex">\(\rho_{TOA}(\Omega_v)\)</span> and radiance <span class="arithmatex">\(L_{TOA}(\Omega_v)\)</span> of Earth surfaces depend on their reflectance <span class="arithmatex">\(\rho_{BOA,Earth}(\Omega_i,\Omega_j)\)</span>, with <span class="arithmatex">\((\Omega_i\in 2\pi^{-}, \Omega_j \in 2\pi^{+})\)</span>, direct sun irradiance <span class="arithmatex">\(E_{BOA,sun}(\Omega_s)\)</span> and atmosphere directional radiance <span class="arithmatex">\(L_{atm}^{\downarrow}(\Omega_i)\)</span> that depend on wavelength and atmosphere conditions. <span class="arithmatex">\(L_{atm}^{\downarrow}(\Omega_i)\)</span> is often assumed to be isotropic and quantified by <span class="arithmatex">\(SKYL(\lambda) = \frac {Atmosphere\:irradiance} {Total\:irradiance}\)</span>.</p>
<p>Atmosphere RT is computer intensive, especially with many bands. Therefore, if many simulations are run with the same atmosphere and sun direction, DART should pre-compute <span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega_i)\)</span> and transfer functions (TF) that represent radiation transfer "<span class="arithmatex">\(BOA \rightarrow MA\)</span>" (i.e., <span class="arithmatex">\(TF_{BOA \rightarrow XXX}, TF_{MA \rightarrow XXX}\)</span>) to a few levels xxx, in order to later simulate <span class="arithmatex">\(L_{TOA}(\Omega_v)\)</span> from <span class="arithmatex">\(L_{BOA}(\Omega_j)\)</span>, with <span class="arithmatex">\(\Omega_j \in 2\pi^{+}\)</span>. TFs depend only on {atmosphere, spectral bands}, and not on sun direction and Earth surface properties, conversely to <span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega_i)\)</span> and <span class="arithmatex">\(L_a(\Omega_v)\)</span>. They must be computed for the scene dimensions, spectral bands and discrete directions (within canopy cameras can be any) of the DART simulation of interest. Cell dimensions must be identical if MA layers have several cells. TFs cannot be used by DART atmosphere Monte Carlo RT.</p>
<p>DART pre-computes <span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega_i)\)</span> and TFs with {atmosphere RT + options <img src="../../media/1.png" width=15/>, <img src="../../media/2.png" width=15/>, <img src="../../media/3.png" width=15/>: see below}. It stores them as 4 files:</p>
<ul>
<li><span class="arithmatex">\(L_{BOA,after\:coupling}^{\downarrow}(\Omega_i)\)</span> <img src="../../media/2.png" width=15/>: function of {atmosphere, <span class="arithmatex">\(\Omega_{sun}\)</span>, N bands}. It can be simulated with {1 ground cell scene, <span class="arithmatex">\(\rho_{ground} \approx &lt;\rho_{scene}&gt;_{xy}\)</span>} to reduce computer time. DART will use it to get BOA products without atmosphere RT simulation.</li>
<li><span class="arithmatex">\(L_{BOA,before\:coupling}^{\downarrow}(\Omega_i)\)</span> <img src="../../media/1.png" width=15/>: function of {atmosphere, <span class="arithmatex">\(\Omega_{sun}\)</span>, N bands}. DART will use it with atmosphere RT simulation.}</li>
<li>TFs <img src="../../media/3.png" width=15/>: 2 files (<span class="arithmatex">\(TF_{BOA \rightarrow XX}, TF_{MA \rightarrow XX}\)</span>): they do not depend on sun direction. They can be simulated with {flat scene, <span class="arithmatex">\(\rho_{ground} = 0\)</span>}. DART will use them with atmosphere RT.</li>
</ul>
<p><center><img src="./media/precomputation.png"><p><em>Pre-computation of:</em></p>
<ul>
<li><img src="../../media/1.png" width=15/> <span class="arithmatex">\(L_{BOA,after\:coupling}^{\downarrow}(\Omega_i)\)</span>,</li>
<li><img src="../../media/2.png" width=15/> <span class="arithmatex">\(L_{BOA,before\:coupling}^{\downarrow}(\Omega_i)\)</span>,</li>
<li><img src="../../media/3.png" width=15/> TFs</p></img></center></li>
</ul>
<p><strong><em>a) Use of the pre-computed atmosphere radiance  <span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega_i)= L_{BOA,after\:coupling}(\Omega_i)\)</span></em></strong><br />
<u><em>Step 1</em></u>: Pre-compute M radiance files {<span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega_i)\)</span>}<span class="arithmatex">\(_m\)</span> for the M configurations {atmosphere, <span class="arithmatex">\(\Omega_{sun}\)</span>, N bands} of interest.</p>
<p><u><em>Step 2</em></u>: Run DART with {No atmosphere RT, <span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega_i)\)</span>}. <span class="arithmatex">\(L_{BOA, backscattered}^{\downarrow}(\Omega)\)</span>. Being a ratio, <span class="arithmatex">\(\rho_{BOA}(\Omega)=\frac {\pi.L_{BOA}^{\uparrow}(\Omega)} {\int_{2\pi^{-}} L_{BOA}^{\downarrow}(\Omega).cos(\theta_i).d\Omega_i}\)</span> is more accurate than <span class="arithmatex">\(L_{BOA}^{\uparrow}(\Omega)\)</span> because <span class="arithmatex">\(L_{BOA,backscattered}^{\downarrow}(\Omega)\)</span> can be inaccurate if <span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega_i)\)</span> is not pre-computed with a the studied scene.</p>
<p><center><img src="./media/use_boa_after_coupling.png"><p><em>Use of <span class="arithmatex">\(L_{BOA,after\:coupling}^{\downarrow}(\Omega_i).\)</span> <span class="arithmatex">\(TF_{MA \rightarrow XX}\)</span> and <span class="arithmatex">\(TF_{BOA \rightarrow XX}\)</span> are not used</em></p></img></center></p>
<p><strong><em>b) Use of the pre-computed atmosphere transfer functions and radiance <span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega)= L_{BOA,before\:coupling}^{\downarrow}(\Omega)\)</span></em></strong></p>
<p><u><em>Step 1</u></em>: Pre-compute <span class="arithmatex">\(L_{BOA,before\:coupling}^{\downarrow}(\Omega_i)\)</span> and TFs (<span class="arithmatex">\(TF_{BOA \rightarrow XXX}, TF_{MA \rightarrow XXX}\)</span>). A 1x1 scene can be used.</p>
<p><u><em>Step 2</em></u>: Run DART with {atmosphere RT, pre-computed TFs and <span class="arithmatex">\(L_{BOA,before\:coupling}^{\downarrow}(\Omega_i)\)</span>} and any surface parameters. Results are those of DART simulations with full atmosphere RT, with much shorter computer time. Slight 
differences can appear if mean reflectance values are computed after being weighted by sun irradiance.</p>
<p><center><img src="./media/use_boa_before_coupling.png"><p><em>Use of <span class="arithmatex">\(L_{BOA,before\:coupling}^{\downarrow}(\Omega_i)\)</span>, <span class="arithmatex">\(TF_{MA \rightarrow XX}\)</span> and <span class="arithmatex">\(TF_{BOA \rightarrow XX}\)</span></em></p></img></center></p>
<p><center><img src="./media/precomputation_atmosphere_radiance.png"><p><em>Step 1: pre-computation of atmosphere radiance <span class="arithmatex">\(L_{BOA}^{\downarrow}(\Omega)\)</span> and transfer functions TFs.</em></p></img></center></p>
<ul>
<li><strong>Atmosphere geometry</strong></li>
</ul>
<p>It has 3 levels: Earth scene (BOA), mid atmosphere MA (cell array with <span class="arithmatex">\(N_{layer,MA}\)</span> levels) <span class="arithmatex">\(\subset [BOA\:altitude\:h_{MA,HA}]\)</span> and high atmosphere HA (<span class="arithmatex">\(N_{layer,HA}\)</span> layers) above MA. Its parameters <span class="arithmatex">\(N_{layer,MA}, N_{layer,HA}\)</span> and <span class="arithmatex">\(h_{MA,HA}\)</span> are input or automatically
computed. They can greatly affect the accuracy of DART products at BOA, TOA and any sensor height <span class="arithmatex">\(h_{sensor}\)</span>.</p>
<ul>
<li><strong>Automatic</strong>: <span class="arithmatex">\(h_{MA,HA} \Leftrightarrow\)</span> Backscattered BOA irradiance = x% . Backscattered atmosphere irradiance. (<span class="arithmatex">\(N_{layer,HA},N_{layer,MA}\)</span>) <span class="arithmatex">\(\Leftrightarrow\)</span> relative error on <span class="arithmatex">\(1^{st}\)</span> order TOA upward and BOA downward irradiance <span class="arithmatex">\(&lt; \epsilon\)</span> for the band with larger <span class="arithmatex">\(\Delta \tau_{atm}\)</span>. One sets: <span class="arithmatex">\(x, \epsilon\)</span> and MA cell size <span class="arithmatex">\((\Delta x, \Delta y)\)</span>. On-going upgrade to consider temperature and extinction coefficient profiles.</li>
<li><strong>Fast</strong>: automatic mode with {x = 0.95, <span class="arithmatex">\(\epsilon\)</span> = 0.02, (<span class="arithmatex">\(\Delta x, \Delta y\)</span>) = scene dimensions}. Usually, it is faster.</li>
<li><strong>Manual</strong>: one sets <span class="arithmatex">\(h_{MA,HA}\)</span>, <span class="arithmatex">\((\Delta x, \Delta y, \Delta z\)</span>) in MA and <span class="arithmatex">\(\Delta z\)</span> in HA. In a sequence, manual mode is advised if atmosphere geometry (e.g., number of atmosphere layers) must be constant.</li>
</ul>
<p><center><img src="./media/atmosphere_geometry.png"><p><em>The atmosphere menu 'Geometry'.</em></p></img></center></p>
<p>Sun TOA and BOA irradiance can be used to get band atmosphere transmittance and material optical properties:</p>
<ul>
<li><strong>Atmosphere unit conversion</strong> (Shunlin Liang, Quantitative Remote Sensing of Land Surfaces p. 225, etc)</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Gas cst R = 8.3144621 J/K/Mol, <span class="arithmatex">\(k = \frac {R} {N_A}=1.38 10^{-23}\)</span> J/K, Avogadro number <span class="arithmatex">\(N_A= 6.022*10^{23} mol./Mole\)</span>. STP (standard T: 0°C, P:1atm)</p>
</div>
<p>Uncondensed gas: 1 atm cm <span class="arithmatex">\(\equiv \frac {Molar\:mass\:M} {Volume_{Mole}:22.4\: 10^3\:cm^3}\:g/cm^2 \equiv \frac {N_A} {22.4\: 10^3\:cm^3}=2.69 \:10^{19}\:mol./cm^2\)</span>.</p>
<p><u><em>Water vapor</em></u> (<span class="arithmatex">\(M_{H_2O} \approx 18g\)</span>): 1 cm <span class="arithmatex">\(H_2O\)</span> precipitable = 1 <span class="arithmatex">\(g/cm^2\)</span> liquid <span class="arithmatex">\(H_2O=\frac {N_A} {M_{H_20}} mol/cm^2 = 3.34\:10^{22}\:mol/cm^2\)</span>.</p>
<p>At STP: 1 atm cm <span class="arithmatex">\(\equiv \frac {M_{H_2O}} {22.4\: 10^3 cm^3} \approx 0.804g/cm^2 \Leftrightarrow 1g\:H_2O/cm^2 \equiv 1.244\:10^3\:atm\:cm\)</span>.</p>
<p><span class="arithmatex">\(P_{saturation}P_{H_2O}^{*} \approx 611.2e^{\frac {17.62(T-273.15)} {T-29.97}}\:Pa\)</span>. Relative humidity <span class="arithmatex">\(RH=\frac {P_{H_2O}} {P_{H_2O}^{*}} \in [0\:1]\)</span>. <span class="arithmatex">\(T_{dew\:point} = \frac {c.[ln(\frac {RH} {100}) + \frac {b.T} {c + T}]} {b - [ln(\frac {RH} {100}) + \frac {b.T} {c + T}]}\)</span>, b=18.678, c=257.14 °C</p>
<p>Ideal gas law <span class="arithmatex">\(\implies\)</span> Vapor density: <span class="arithmatex">\(\frac {P_{H_2O}} {R.T}\)</span> Mole/<span class="arithmatex">\(m^3\)</span> = <span class="arithmatex">\(\frac {P_{H_2O}} {k.T}\)</span> mol/<span class="arithmatex">\(m^3\)</span>=<span class="arithmatex">\(\frac {216.67.P_{H_2O}} {T}\:g/m^3.\int_{\Delta z} g/cm^3 \implies X\:g_{H_2O}/cm^2 \implies 1.244\:10^3X\:atm\:cm\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Gas profile unit in DART file <code>atmosphere.txt</code>: atm cm/km (<span class="arithmatex">\(N_2\)</span>: <span class="arithmatex">\(g/cm^2km\)</span>).</p>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>